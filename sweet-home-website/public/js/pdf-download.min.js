!function(){"use strict";const e=document.getElementById("pdfLoadingModal"),t=document.querySelectorAll(".js-download-expose");let o=!1;function r(){e&&(e.style.display="none",document.body.style.overflow="",o=!1)}function n(){t.forEach(e=>{e.disabled=!1,e.style.opacity="1",e.style.cursor="pointer"})}function d(d){if(d.preventDefault(),o)return;const s=d.currentTarget,c=s.getAttribute("data-slug"),l=s.getAttribute("data-type");if(!c||!l)return void console.error("PDF download: Missing slug or type");const a=`/${"property"===l?"properties":"projects"}/${c}/pdf`,i=`${l}-${c}-expose.pdf`;e&&(e.style.display="flex",document.body.style.overflow="hidden",o=!0),t.forEach(e=>{e.disabled=!0,e.style.opacity="0.6",e.style.cursor="not-allowed"}),function(e,t){return fetch(e).then(e=>{if(!e.ok){if(e.headers.get("content-type")?.includes("text/plain"))return e.text().then(t=>{throw new Error(t||`HTTP error! status: ${e.status}`)});throw new Error(`HTTP error! status: ${e.status}`)}return e.blob()}).then(e=>{const o=document.createElement("a");o.href=URL.createObjectURL(e),o.download=t||"expose.pdf",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(o.href)})}(a,i).then(()=>{r(),n()}).catch(e=>{console.error("PDF download error:",e),r(),n(),alert("Error downloading PDF: "+(e.message||"An unexpected error occurred. Please try again."))})}t.length>0&&t.forEach(e=>{e.addEventListener("click",d)})}();