<% title = 'Manage Blog' %>
<link rel="stylesheet" href="/css/superadmin/manage-blog.css" />
<div class="admin-panel">
  <div class="admin-body">
    <%- include('../../partials/superadmin-sidebar', { activePage: 'blog', pendingCount: pendingCount }) %>
    <main class="admin-content blog-manage">
      <div class="admin-header">
        <div>
          <h1>Manage Blog</h1>
          <p class="subtitle">View and manage all posts</p>
        </div>
        <a href="/superadmin/dashboard/blog/new" class="btn">+ New Post</a>
      </div>
      <table class="table">
        <thead>
          <tr>
            <th>Title</th>
            <th>Status</th>
            <th>Author</th>
            <th>Updated</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <% if ((posts || []).length === 0) { %>
            <tr><td colspan="5">No posts yet.</td></tr>
          <% } %>
          <% (posts || []).forEach(p => { %>
            <tr>
              <td><%= p.title %></td>
              <td><%= p.status %></td>
              <td><%= (currentUser && p.author_id === currentUser.id) ? 'You' : (p.author_name || '-') %></td>
              <td><%= new Date(p.updated_at || p.created_at).toLocaleString() %></td>
              <td>
                <a href="/superadmin/dashboard/blog/<%= p.id %>/edit" class="btn-link">Edit</a>
                <form action="/superadmin/dashboard/blog/<%= p.id %>/delete?_csrf=<%= csrfToken %>" method="post" onsubmit="return confirm('Are you sure you want to delete this blog post? This action cannot be undone.')" style="display: inline-block; margin-left: 8px;">
                  <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                  <button type="submit" class="btn-link btn-link--danger">Delete</button>
                </form>
              </td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </main>
  </div>
</div>

