<%
  const siteBaseUrl = ((typeof baseUrl !== 'undefined' && baseUrl) ? baseUrl : (process.env.APP_URL || 'https://sweethome.com')).replace(/\/$/, '');
  const pageUrl = `${siteBaseUrl}/properties-for-sale-berlin`;
  const pageDesc = (typeof pageMetaDescription !== 'undefined' && pageMetaDescription) ? pageMetaDescription : 'Find properties for sale in Berlin, Germany. Browse the most viewed apartments, houses, and villas. Expert real estate guidance from Sweet Home.';
  const pageTitle = (typeof title !== 'undefined' && title) ? title : 'Properties for Sale in Berlin';
%>
<meta name="description" content="<%= pageDesc %>">
<!-- Canonical and hreflang are output by main layout when canonicalUrl is passed -->

<!-- Open Graph -->
<meta property="og:type" content="website">
<meta property="og:title" content="<%= pageTitle %> | Sweet Home">
<meta property="og:description" content="<%= pageDesc %>">
<meta property="og:url" content="<%= (typeof canonicalUrl !== 'undefined' && canonicalUrl) ? canonicalUrl : pageUrl %>">
<meta property="og:image" content="<%= siteBaseUrl %>/images/berlin-hero.jpg">
<meta property="og:image:alt" content="Properties for sale in Berlin, Germany – Sweet Home real estate">
<meta property="og:site_name" content="Sweet Home">
<meta property="og:locale" content="en_US">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="<%= pageTitle %> | Sweet Home">
<meta name="twitter:description" content="<%= pageDesc %>">
<meta name="twitter:image" content="<%= siteBaseUrl %>/images/berlin-hero.jpg">
<meta name="twitter:image:alt" content="Properties for sale in Berlin, Germany – Sweet Home real estate">

<!-- JSON-LD WebPage + BreadcrumbList -->
<script type="application/ld+json"><%- (typeof minifyJSON !== 'undefined' ? minifyJSON({
  '@context': 'https://schema.org',
  '@graph': [
    {
      '@type': 'WebPage',
      '@id': pageUrl + '#webpage',
      name: pageTitle + ' | Sweet Home',
      description: pageDesc,
      url: (typeof canonicalUrl !== 'undefined' && canonicalUrl) ? canonicalUrl : pageUrl,
      isPartOf: { '@type': 'WebSite', '@id': siteBaseUrl + '/#website', name: 'Sweet Home' }
    },
    {
      '@type': 'BreadcrumbList',
      itemListElement: [
        { '@type': 'ListItem', position: 1, name: 'Home', item: siteBaseUrl + '/' },
        { '@type': 'ListItem', position: 2, name: pageTitle, item: (typeof canonicalUrl !== 'undefined' && canonicalUrl) ? canonicalUrl : pageUrl }
      ]
    }
  ]
}) : JSON.stringify({
  '@context': 'https://schema.org',
  '@graph': [
    {
      '@type': 'WebPage',
      '@id': pageUrl + '#webpage',
      name: pageTitle + ' | Sweet Home',
      description: pageDesc,
      url: (typeof canonicalUrl !== 'undefined' && canonicalUrl) ? canonicalUrl : pageUrl,
      isPartOf: { '@type': 'WebSite', '@id': siteBaseUrl + '/#website', name: 'Sweet Home' }
    },
    {
      '@type': 'BreadcrumbList',
      itemListElement: [
        { '@type': 'ListItem', position: 1, name: 'Home', item: siteBaseUrl + '/' },
        { '@type': 'ListItem', position: 2, name: pageTitle, item: (typeof canonicalUrl !== 'undefined' && canonicalUrl) ? canonicalUrl : pageUrl }
      ]
    }
  ]
})) %></script>

<!-- JSON-LD ItemList for recommended properties -->
<% if (typeof recommendedProperties !== 'undefined' && recommendedProperties && recommendedProperties.length > 0) { %>
<script type="application/ld+json"><%- (typeof minifyJSON !== 'undefined' ? minifyJSON({
  '@context': 'https://schema.org',
  '@type': 'ItemList',
  name: 'Properties for Sale in Berlin',
  description: pageDesc,
  itemListElement: recommendedProperties.map((p, idx) => ({
    '@type': 'ListItem',
    position: idx + 1,
    item: {
      '@type': 'RealEstateListing',
      name: p.title,
      url: `${siteBaseUrl}/properties/${p.slug}`,
      address: {
        '@type': 'PostalAddress',
        addressLocality: p.city || 'Berlin',
        addressCountry: p.country || 'Germany'
      }
    }
  }))
}) : JSON.stringify({
  '@context': 'https://schema.org',
  '@type': 'ItemList',
  name: 'Properties for Sale in Berlin',
  description: pageDesc,
  itemListElement: recommendedProperties.map((p, idx) => ({
    '@type': 'ListItem',
    position: idx + 1,
    item: {
      '@type': 'RealEstateListing',
      name: p.title,
      url: `${siteBaseUrl}/properties/${p.slug}`,
      address: {
        '@type': 'PostalAddress',
        addressLocality: p.city || 'Berlin',
        addressCountry: p.country || 'Germany'
      }
    }
  }))
})) %></script>
<% } %>
