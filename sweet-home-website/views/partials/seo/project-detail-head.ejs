<% if (typeof project !== 'undefined' && project) { 
  const siteBaseUrl = ((typeof baseUrl !== 'undefined' && baseUrl) ? baseUrl : (process.env.APP_URL || 'https://sweethome.com')).replace(/\/$/, '');
  const projectUrl = `${siteBaseUrl}/projects/${project.slug}`;
  const projectImage = (project.photos && project.photos[0]) 
    ? (project.photos[0].startsWith('http') ? project.photos[0] : `${siteBaseUrl}${project.photos[0]}`)
    : `${siteBaseUrl}/img/property-placeholder.jpg`;
  const projectDescription = (project.description || '').slice(0, 160) || `${project.title} - ${project.city}, ${project.country}`;
%>
<meta name="description" content="<%= projectDescription %>">
<link rel="canonical" href="<%= projectUrl %>">

<!-- Open Graph -->
<meta property="og:type" content="website">
<meta property="og:title" content="<%= project.title %>">
<meta property="og:description" content="<%= (project.description || '').slice(0, 200) || projectDescription %>">
<meta property="og:url" content="<%= projectUrl %>">
<meta property="og:image" content="<%= projectImage %>">
<meta property="og:site_name" content="Sweet Home">
<meta property="og:locale" content="en_US">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="<%= project.title %>">
<meta name="twitter:description" content="<%= (project.description || '').slice(0, 200) || projectDescription %>">
<meta name="twitter:image" content="<%= projectImage %>">

<!-- JSON-LD Structured Data -->
<script type="application/ld+json">
<%- JSON.stringify({
  '@context': 'https://schema.org',
  '@type': 'ResidentialComplex',
  name: project.title,
  description: project.description || '',
  image: (project.photos && project.photos.length > 0) 
    ? project.photos.map(p => p.startsWith('http') ? p : `${siteBaseUrl}${p}`)
    : [`${siteBaseUrl}/img/property-placeholder.jpg`],
  url: projectUrl,
  address: {
    '@type': 'PostalAddress',
    addressLocality: project.city,
    addressRegion: project.neighborhood || '',
    addressCountry: project.country
  },
  geo: (project.latitude && project.longitude) ? {
    '@type': 'GeoCoordinates',
    latitude: Number(project.latitude),
    longitude: Number(project.longitude)
  } : undefined,
  numberOfUnits: project.total_units ? Number(project.total_units) : undefined,
  priceRange: (project.min_price || project.max_price) ? {
    '@type': 'PriceSpecification',
    minPrice: project.min_price ? Number(project.min_price) : undefined,
    maxPrice: project.max_price ? Number(project.max_price) : undefined,
    priceCurrency: 'EUR'
  } : undefined
}) %>
</script>
<script type="application/ld+json">
<%- JSON.stringify({
  '@context': 'https://schema.org',
  '@type': 'BreadcrumbList',
  itemListElement: [
    {
      '@type': 'ListItem',
      position: 1,
      name: 'Projects',
      item: `${siteBaseUrl}/projects`
    },
    {
      '@type': 'ListItem',
      position: 2,
      name: project.country,
      item: `${siteBaseUrl}/projects?country=${encodeURIComponent(project.country)}`
    },
    {
      '@type': 'ListItem',
      position: 3,
      name: project.city,
      item: `${siteBaseUrl}/projects?country=${encodeURIComponent(project.country)}&city=${encodeURIComponent(project.city)}`
    },
    {
      '@type': 'ListItem',
      position: 4,
      name: project.title,
      item: projectUrl
    }
  ]
}) %>
</script>
<% } %>

