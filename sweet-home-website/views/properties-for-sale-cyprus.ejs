<% useMainContainer = false %>
<% useHomeHeader = true %>
<link rel="stylesheet" href="/css/home.css" />
<link rel="stylesheet" href="/css/berlin-landing.css" />

<div id="locations-data" data-locations='<%- (typeof minifyJSON !== 'undefined' ? minifyJSON(locations) : JSON.stringify(locations)).replace(/'/g, '&#39;') %>' style="display:none"></div>

<div class="berlin-landing-page">
  <!-- 1) Hero -->
  <section class="berlin-hero" aria-labelledby="cyprus-hero-title">
    <div class="berlin-hero__bg">
      <img src="/images/cyprus-international.jpg" alt="<%= t('cyprus.heroImgAlt','Cyprus – properties for sale in Cyprus') %>" fetchpriority="high" decoding="async">
    </div>
    <div class="berlin-hero__overlay"></div>
    <div class="berlin-hero__content">
      <h1 id="cyprus-hero-title" class="berlin-hero__title"><%= t('cyprus.heroTitle','Properties for Sale in Cyprus') %></h1>
      <p class="berlin-hero__description"><%= t('cyprus.heroDescription','Discover carefully selected properties for sale in Cyprus, an EU member with a resilient real estate market. Sweet Home supports international buyers and investors with expert guidance and access to residential and coastal opportunities.') %></p>
    </div>
  </section>

  <!-- 2) Search bar (Cyprus default) -->
  <section id="cyprus-search" class="berlin-search" aria-labelledby="cyprus-search-title">
    <h2 id="cyprus-search-title" class="berlin-search__title sr-only"><%= t('home.search.cta','Search Properties') %></h2>
    <form action="/properties" method="get" class="berlin-search__form">
      <div class="berlin-search__row">
        <label class="sr-only" for="country"><%= t('forms.country','Country') %></label>
        <select id="country" name="country" aria-label="<%= t('forms.country','Country') %>">
          <option value=""><%= t('forms.country','Country') %></option>
          <% Object.keys(locations).forEach(c => { %>
            <option value="<%= c %>" <%= c === 'Cyprus' ? 'selected' : '' %>><%= c %></option>
          <% }); %>
        </select>
        <label class="sr-only" for="city"><%= t('forms.city','City') %></label>
        <select id="city" name="city" aria-label="<%= t('forms.city','City') %>">
          <option value=""><%= t('forms.city','City') %></option>
          <% if (locations.Cyprus) { Object.keys(locations.Cyprus).forEach(ct => { %>
            <option value="<%= ct %>" <%= ct === 'Paphos' ? 'selected' : '' %>><%= ct %></option>
          <% }); } %>
        </select>
        <label class="sr-only" for="neighborhood"><%= t('forms.neighborhood','Neighborhood') %></label>
        <select id="neighborhood" name="neighborhood" disabled aria-label="<%= t('forms.neighborhood','Neighborhood') %>">
          <option value=""><%= t('forms.neighborhood','Neighborhood') %></option>
        </select>
        <label class="sr-only" for="operation"><%= t('forms.operation','Operation') %></label>
        <select id="operation" name="operation">
          <option value=""><%= t('forms.anyOperation','Any Operation') %></option>
          <option value="buy" selected><%= t('forms.operations.buy','Buy') %></option>
          <option value="rent"><%= t('forms.operations.rent','Rent') %></option>
        </select>
        <label class="sr-only" for="type"><%= t('forms.propertyType','Property Type') %></label>
        <select id="type" name="type">
          <option value=""><%= t('forms.anyType','Any Type') %></option>
          <option><%= t('forms.types.apartment','Apartment') %></option>
          <option><%= t('forms.types.house','House') %></option>
          <option><%= t('forms.types.villa','Villa') %></option>
          <option><%= t('forms.types.land','Land') %></option>
        </select>
        <button type="submit"><%= t('home.search.cta','Search Properties') %></button>
      </div>
    </form>
  </section>

  <!-- 3) Featured properties -->
  <section class="section featured berlin-featured" aria-labelledby="recommended-heading">
    <h2 id="recommended-heading" class="berlin-featured__title"><%= t('cyprus.featuredTitle','Featured properties') %></h2>
    <div class="berlin-featured__grid" id="cyprusRecommended">
      <% (recommendedProperties || []).forEach(property => { %>
        <%
          const photoUrl = (property.photos && property.photos[0]) ? property.photos[0] : '/img/property-placeholder.jpg';
          const size = property.size ? `${property.size} m²` : null;
          const beds = (typeof property.rooms !== 'undefined' && property.rooms !== null) ? property.rooms : null;
          const baths = (typeof property.bathrooms !== 'undefined' && property.bathrooms !== null) ? property.bathrooms : null;
          const priceText = property.price && Number(property.price) > 0 ? '€' + Number(property.price).toLocaleString('en-US') : '';
        %>
        <article class="property-card">
          <a href="/properties/<%= property.slug %>" class="property-card-link">
            <div class="img-wrap" <%= priceText ? `data-price="${priceText}"` : '' %>>
              <img src="<%= photoUrl %>" alt="<%= property.title %>" loading="lazy" decoding="async" onerror="this.src='/img/property-placeholder.jpg'">
            </div>
            <div class="meta">
              <div class="title"><%= property.title %></div>
              <% if (priceText) { %><div class="price"><%= priceText %></div><% } %>
              <div class="location">
                <span class="icon icon-16 icon-inline icon-mask icon-location" style="color: currentColor;"></span>
                <%= property.neighborhood || property.city %>, <%= property.country %>
              </div>
              <div class="features-row">
                <% if (size) { %>
                  <div class="feature">
                    <span class="icon icon-16 icon-inline icon-mask icon-size"></span>
                    <span><%= size %></span>
                  </div>
                <% } %>
                <% if (beds !== null) { %>
                  <div class="feature">
                    <span class="icon icon-16 icon-inline icon-mask icon-bed"></span>
                    <span><%= beds %> bed<%= Number(beds) === 1 ? '' : 's' %></span>
                  </div>
                <% } %>
                <% if (baths !== null) { %>
                  <div class="feature">
                    <span class="icon icon-16 icon-inline icon-mask icon-bath"></span>
                    <span><%= baths %> bath<%= Number(baths) === 1 ? '' : 's' %></span>
                  </div>
                <% } %>
              </div>
              <span class="learn-more"><%= t('properties.list.viewDetails','View details') %> →</span>
            </div>
          </a>
        </article>
      <% }); %>
    </div>
    <% if (!recommendedProperties || recommendedProperties.length === 0) { %>
      <p class="section-empty"><%= t('properties.list.noResults','No properties found.') %> <a href="/properties?country=Cyprus"><%= t('home.search.cta','Search Properties') %></a></p>
    <% } else { %>
      <p class="section-cta">
        <a href="/properties?country=Cyprus" class="btn btn-primary"><%= t('cyprus.viewAll','View all properties in Cyprus') %></a>
      </p>
    <% } %>
  </section>

  <!-- 4) FAQ: Cyprus real estate (from KPMG 13th Edition & PwC Year in Review 2024) -->
  <section class="berlin-faq section" aria-labelledby="cyprus-faq-heading">
    <h2 id="cyprus-faq-heading" class="berlin-faq__title"><%= t('cyprus.faqTitle','Frequently asked questions about buying property in Cyprus') %></h2>
    <div class="berlin-faq__list">
      <article class="berlin-faq__item">
        <h3 class="berlin-faq__question">
          <button type="button" class="berlin-faq__trigger" aria-expanded="false" aria-controls="cyprus-faq-a1" id="cyprus-faq-q1" data-faq-toggle>
            <%= t('cyprus.faqQ1','Why invest in Cyprus real estate?') %>
          </button>
        </h3>
        <div class="berlin-faq__answer" id="cyprus-faq-a1" role="region" aria-labelledby="cyprus-faq-q1" hidden>
          <p><%= t('cyprus.faqA1','Cyprus is an EU member with an attractive tax regime (e.g. corporate tax 12.5%), a large network of double tax treaties, and a common-law legal system. Real estate and construction contributed 16% of GVA in 2023. In 2024, total transaction value reached €5.7bn with residential demand driving 67% of the market. Sovereign credit ratings have been upgraded to investment grade with a positive outlook, reflecting improved fiscal stability and reduced banking risks.') %></p>
        </div>
      </article>
      <article class="berlin-faq__item">
        <h3 class="berlin-faq__question">
          <button type="button" class="berlin-faq__trigger" aria-expanded="false" aria-controls="cyprus-faq-a2" id="cyprus-faq-q2" data-faq-toggle>
            <%= t('cyprus.faqQ2','How active is the Cyprus residential market?') %>
          </button>
        </h3>
        <div class="berlin-faq__answer" id="cyprus-faq-a2" role="region" aria-labelledby="cyprus-faq-q2" hidden>
          <p><%= t('cyprus.faqA2','In 2024, 23,900 transactions were recorded (a 3% drop compared to 2023) with a total value of €5.71bn (1% growth). Limassol made up the majority of transaction value at 44%, followed by Nicosia and Paphos at 18% each, and Larnaca at 16%. In terms of volume, Limassol led with 29%, then Nicosia (27%) and Larnaca (21%). Residential assets represented 67% of total transaction value.') %></p>
        </div>
      </article>
      <article class="berlin-faq__item">
        <h3 class="berlin-faq__question">
          <button type="button" class="berlin-faq__trigger" aria-expanded="false" aria-controls="cyprus-faq-a3" id="cyprus-faq-q3" data-faq-toggle>
            <%= t('cyprus.faqQ3','Where are the most active areas in Cyprus?') %>
          </button>
        </h3>
        <div class="berlin-faq__answer" id="cyprus-faq-a3" role="region" aria-labelledby="cyprus-faq-q3" hidden>
          <p><%= t('cyprus.faqA3','Limassol leads in both volume (29%) and value (44%) of transactions. Nicosia follows with 27% of volume and 18% of value; Larnaca 21% volume and 16% value; Paphos 18% of value. For foreign buyers, Paphos and Limassol made up the majority of acquisitions in 2024 (32% and 29% respectively). Limassol led apartment transaction values in 2023, reaching €1.8bn and 3,053 units.') %></p>
        </div>
      </article>
      <article class="berlin-faq__item">
        <h3 class="berlin-faq__question">
          <button type="button" class="berlin-faq__trigger" aria-expanded="false" aria-controls="cyprus-faq-a4" id="cyprus-faq-q4" data-faq-toggle>
            <%= t('cyprus.faqQ4','How have property prices and the high-end segment performed?') %>
          </button>
        </h3>
        <div class="berlin-faq__answer" id="cyprus-faq-a4" role="region" aria-labelledby="cyprus-faq-q4" hidden>
          <p><%= t('cyprus.faqA4','Residential property index prices maintained a stable upward trend in 2024 with around 7% year-on-year increase (data to Q3). The high-end segment (single residential properties ≥€1.5m) improved marginally: 188 transactions were recorded in 2024 with total values reaching €550m, a 4% year-on-year increase. New building permits issued in 2024 saw a 2% increase in value terms.') %></p>
        </div>
      </article>
      <article class="berlin-faq__item">
        <h3 class="berlin-faq__question">
          <button type="button" class="berlin-faq__trigger" aria-expanded="false" aria-controls="cyprus-faq-a5" id="cyprus-faq-q5" data-faq-toggle>
            <%= t('cyprus.faqQ5','Is now a good time to buy property in Cyprus?') %>
          </button>
        </h3>
        <div class="berlin-faq__answer" id="cyprus-faq-a5" role="region" aria-labelledby="cyprus-faq-q5" hidden>
          <p><%= t('cyprus.faqA5','The Cyprus real estate market has shown resilience and flexibility, maintaining record-high transaction values. The economy continues to outperform the Eurozone average with sovereign rating upgrades. Lending improved: new mortgage facilities increased 7% in 2024 versus 2023. Tourism, real estate and ICT remain key growth drivers. Sweet Home can help you explore carefully selected properties and provide expert guidance for buying or investing in Cyprus.') %></p>
        </div>
      </article>
    </div>
    <p class="berlin-faq__source"><%= t('cyprus.faqSource','Sources: KPMG Cyprus Real Estate Insights 13th Edition (2024); PwC Cyprus Real Estate Market Year in Review 2024.') %></p>
  </section>
</div>

<script>
document.querySelectorAll('[data-faq-toggle]').forEach(function(btn) {
  btn.addEventListener('click', function() {
    var expanded = this.getAttribute('aria-expanded') === 'true';
    var targetId = this.getAttribute('aria-controls');
    var target = targetId ? document.getElementById(targetId) : null;
    this.setAttribute('aria-expanded', !expanded);
    if (target) target.hidden = expanded;
  });
});
</script>
<script>
(function headerShrink() {
  var header = document.querySelector('.site-header.gradient') || document.querySelector('.site-header');
  if (!header) return;
  function update() {
    if (window.scrollY > 40) header.classList.add('shrink');
    else header.classList.remove('shrink');
  }
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function run() {
      update();
      window.addEventListener('scroll', update, { passive: true });
    });
  } else {
    update();
    window.addEventListener('scroll', update, { passive: true });
  }
})();

(function() {
  var locationsEl = document.getElementById('locations-data');
  if (locationsEl && typeof window !== 'undefined') {
    try {
      window.locations = JSON.parse(locationsEl.getAttribute('data-locations') || '{}');
    } catch (e) {}
  }
  var countrySelect = document.getElementById('country');
  var citySelect = document.getElementById('city');
  var neighborhoodSelect = document.getElementById('neighborhood');
  if (countrySelect && citySelect && neighborhoodSelect && window.locations) {
    citySelect.disabled = false;
    countrySelect.addEventListener('change', function() {
      var country = this.value;
      citySelect.innerHTML = '<option value="">' + (document.documentElement.lang === 'de' ? 'Stadt' : document.documentElement.lang === 'es' ? 'Ciudad' : 'City') + '</option>';
      neighborhoodSelect.innerHTML = '<option value="">' + (document.documentElement.lang === 'de' ? 'Stadtteil' : document.documentElement.lang === 'es' ? 'Barrio' : 'Neighborhood') + '</option>';
      neighborhoodSelect.disabled = true;
      if (country && window.locations[country]) {
        Object.keys(window.locations[country]).forEach(function(ct) {
          var opt = document.createElement('option');
          opt.value = ct;
          opt.textContent = ct;
          citySelect.appendChild(opt);
        });
        citySelect.disabled = false;
      } else {
        citySelect.disabled = true;
      }
    });
    citySelect.addEventListener('change', function() {
      var country = countrySelect.value;
      var city = this.value;
      neighborhoodSelect.innerHTML = '<option value="">' + (document.documentElement.lang === 'de' ? 'Stadtteil' : document.documentElement.lang === 'es' ? 'Barrio' : 'Neighborhood') + '</option>';
      if (country && city && window.locations[country] && window.locations[country][city]) {
        var neighborhoods = window.locations[country][city];
        if (Array.isArray(neighborhoods) && neighborhoods.length > 0) {
          neighborhoods.forEach(function(n) {
            var opt = document.createElement('option');
            opt.value = n;
            opt.textContent = n;
            neighborhoodSelect.appendChild(opt);
          });
          neighborhoodSelect.disabled = false;
        } else {
          neighborhoodSelect.disabled = false;
        }
      } else {
        neighborhoodSelect.disabled = true;
      }
    });
    if (countrySelect.value === 'Cyprus' && window.locations.Cyprus) {
      if (citySelect.options.length <= 1) {
        Object.keys(window.locations.Cyprus).forEach(function(ct) {
          var opt = document.createElement('option');
          opt.value = ct;
          opt.textContent = ct;
          citySelect.appendChild(opt);
        });
      }
      citySelect.value = 'Paphos';
      citySelect.dispatchEvent(new Event('change', { bubbles: true }));
    }
  }
})();
</script>
